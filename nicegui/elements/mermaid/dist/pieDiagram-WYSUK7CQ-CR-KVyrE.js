import{c as e}from"./chunk-4KE642ED-_NPJ3N4I.js";import{p as t}from"./gitGraph-F2EDSAW4-LKDW3VZQ-DVC0VkBM.js";import{m as a,M as i,F as n,B as r,w as l,A as s,L as o,J as p,Q as d,l as c,a5 as g,a7 as h,a8 as u,a9 as m,k as f,v as x,aa as S,n as w}from"./index-Dne072Ek.js";import"./chunk-BKDDFIKN-CmrN6bhn.js";var D=w.pie,y={sections:new Map,showData:!1},$=y.sections,T=y.showData,C=structuredClone(D),k={getConfig:a(()=>structuredClone(C),"getConfig"),clear:a(()=>{$=new Map,T=y.showData,x()},"clear"),setDiagramTitle:o,getDiagramTitle:s,setAccTitle:l,getAccTitle:r,setAccDescription:n,getAccDescription:i,addSection:a(({label:e,value:t})=>{$.has(e)||($.set(e,t),p.debug(`added new section: ${e}, with value: ${t}`))},"addSection"),getSections:a(()=>$,"getSections"),setShowData:a(e=>{T=e},"setShowData"),getShowData:a(()=>T,"getShowData")},v=a((t,a)=>{e(t,a),a.setShowData(t.showData),t.sections.map(a.addSection)},"populateDb"),b={parse:a(async e=>{let a=await t("pie",e);p.debug(a),v(a,k)},"parse")},A=a(e=>`\n  .pieCircle{\n    stroke: ${e.pieStrokeColor};\n    stroke-width : ${e.pieStrokeWidth};\n    opacity : ${e.pieOpacity};\n  }\n  .pieOuterCircle{\n    stroke: ${e.pieOuterStrokeColor};\n    stroke-width: ${e.pieOuterStrokeWidth};\n    fill: none;\n  }\n  .pieTitleText {\n    text-anchor: middle;\n    font-size: ${e.pieTitleTextSize};\n    fill: ${e.pieTitleTextColor};\n    font-family: ${e.fontFamily};\n  }\n  .slice {\n    font-family: ${e.fontFamily};\n    fill: ${e.pieSectionTextColor};\n    font-size:${e.pieSectionTextSize};\n    // fill: white;\n  }\n  .legend text {\n    fill: ${e.pieLegendTextColor};\n    font-family: ${e.fontFamily};\n    font-size: ${e.pieLegendTextSize};\n  }\n`,"getStyles"),F=a(e=>{let t=[...e.entries()].map(e=>({label:e[0],value:e[1]})).sort((e,t)=>t.value-e.value);return S().value(e=>e.value)(t)},"createPieArcs"),z=a((e,t,a,i)=>{p.debug("rendering pie chart\n"+e);let n=i.db,r=d(),l=c(n.getConfig(),r.pie),s=18,o=450,x=o,S=g(t),w=S.append("g");w.attr("transform","translate(225,225)");let{themeVariables:D}=r,[y]=h(D.pieOuterStrokeWidth);y??=2;let $=l.textPosition,T=Math.min(x,o)/2-40,C=u().innerRadius(0).outerRadius(T),k=u().innerRadius(T*$).outerRadius(T*$);w.append("circle").attr("cx",0).attr("cy",0).attr("r",T+y/2).attr("class","pieOuterCircle");let v=n.getSections(),b=F(v),A=[D.pie1,D.pie2,D.pie3,D.pie4,D.pie5,D.pie6,D.pie7,D.pie8,D.pie9,D.pie10,D.pie11,D.pie12],z=m(A);w.selectAll("mySlices").data(b).enter().append("path").attr("d",C).attr("fill",e=>z(e.data.label)).attr("class","pieCircle");let M=0;v.forEach(e=>{M+=e}),w.selectAll("mySlices").data(b).enter().append("text").text(e=>(e.data.value/M*100).toFixed(0)+"%").attr("transform",e=>"translate("+k.centroid(e)+")").style("text-anchor","middle").attr("class","slice"),w.append("text").text(n.getDiagramTitle()).attr("x",0).attr("y",-200).attr("class","pieTitleText");let O=w.selectAll(".legend").data(z.domain()).enter().append("g").attr("class","legend").attr("transform",(e,t)=>"translate(216,"+(22*t-22*z.domain().length/2)+")");O.append("rect").attr("width",s).attr("height",s).style("fill",z).style("stroke",z),O.data(b).append("text").attr("x",22).attr("y",14).text(e=>{let{label:t,value:a}=e.data;return n.getShowData()?`${t} [${a}]`:t});let W=512+Math.max(...O.selectAll("text").nodes().map(e=>e?.getBoundingClientRect().width??0));S.attr("viewBox",`0 0 ${W} 450`),f(S,o,W,l.useMaxWidth)},"draw"),M={parser:b,db:k,renderer:{draw:z},styles:A};export{M as diagram};
//# sourceMappingURL=pieDiagram-WYSUK7CQ-CR-KVyrE.js.map
